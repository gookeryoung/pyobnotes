---
aliases: ndarray.数组维度理解
tags: ndarray.数组维度理解
title: 02.ndarray.数组维度理解
date created: 星期四, 十月 6日 2022, 10:44:15 晚上
date modified: 星期五, 十月 7日 2022, 10:30:18 晚上
---

# 02.ndarray.数组维度理解

## 基本思路

关于 `ndarray`，数组维度元组 `shape` 是需要理解的基本特征。

可以采取 `逆向` 分析方法理解其在每个维度下包含了多少个元素，即 `shape` 形如 `(x1, x2, …, xn)` 的数组，可进行如下分析：

- 倒数第 1 层：包含了 `xn` 个元素的 `1维` 数组；
- 倒数第 2 层：包含了 `x(n-1)` 个元素的 `2维` 数组，每个元素都等价于倒数第 1 层；
- …
- 第 2 层：包含了 `x2` 个元素的 `n-1` 维数组，每个元素都等价于第 3 层；
- 第 1 层：包含了 `x1` 个元素的 `n` 维数组，每个元素都等价于第 2 层。

## 示例 1

例如，要构造一个 `shape` 是 (2, 3, 3, 2) 的数组，可以采用以下步骤：

- 构造第 4 层，1 维 2 元素：

```python
[1, 2]
```

- 构造第 3 层，2 维 3 元素，由 3 个第 4 层组成：

```python
[[1, 2], [1, 2], [1, 2]]
```

- 构造第 2 层，3 维 3 元素，由 3 个第 3 层组成：

```python
[[[1, 2], [1, 2], [1, 2]],
 [[1, 2], [1, 2], [1, 2]],
 [[1, 2], [1, 2], [1, 2]]]
```

- 构造第 1 层：4 维 2 元素，由 2 个第 2 层组成：

```python
[[[[1, 2], [1, 2], [1, 2]],
  [[1, 2], [1, 2], [1, 2]],
  [[1, 2], [1, 2], [1, 2]]],

 [[[1, 2], [1, 2], [1, 2]],
  [[1, 2], [1, 2], [1, 2]],
  [[1, 2], [1, 2], [1, 2]]]]
```

示例代码：

```python
import numpy as np

arr = np.array(
	[[[[1, 2], [1, 2], [1, 2]],
	  [[1, 2], [1, 2], [1, 2]],
	  [[1, 2], [1, 2], [1, 2]]],

	 [[[1, 2], [1, 2], [1, 2]],
	  [[1, 2], [1, 2], [1, 2]],
	  [[1, 2], [1, 2], [1, 2]]]],
	np.int16
)
print(arr.shape, arr.size, arr.nbytes)
```

```python
(2, 3, 3, 2) 36 72
```

## 示例 2：

假设要构建一个游戏地图，地图包含 x，y 坐标，并且有树木、墙壁、水域、冰块等不同物体，可以采用如下 `n×2×2` 维数据进行设计：

- 第 1 维的 n 代表物体数量，可以随意扩展；
- 第 2 维包含 2 个二维数据，一组 (x, y) 表示坐标，另一组 (series, code) 表示物体系列代号；

示例代码：

```python
import numpy as np

objects = np.array(
	[[[120, 115], [1, 2]],
	 [[121, 120], [2, 3]],
	 [[200, 210], [1, 1]]],
	np.int16
)

for obj in objects:
	print(f'obj{obj[1][0], obj[1][1]}->pos{obj[0][0], obj[0][1]}')
```

运行结果：

```python
obj(1, 2)->pos(120, 115)
obj(2, 3)->pos(121, 120)
obj(1, 1)->pos(200, 210)
```
